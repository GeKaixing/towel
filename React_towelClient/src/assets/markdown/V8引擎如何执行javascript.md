2023/12/27
### V8引擎编译javascript流程
2015年前的版本v8直接将js编译机械码。执行速度很快，但是占用内存，所以在V8在5.9版本的加入了先编译为字节码在编译为字节码。v8的字节码是机械码的抽象
### 解析器
javasrcipt源码先经过解析器为**AST抽象语法树**和作用域。解析器先词法分析器Scanner然后语法器parser分析，scanner接受unicode字符流将源码拆分成最小，不可再分的词法单元tokens。语法分析会将词法单元转换为一个由元素逐级嵌套所组成的程序结构的树，在转换中会解析出js的编写错误。V8会使用pre-parser预解析来提高效率，不会解析没有调用的函数体。预解析函数声明，函数语法是否有效，函数作用域，不会生成AST抽象语法树。解决全部解析的话，代码执行时间变长，占用内存和磁盘空间
### 解释器
解释器lgnition根据通用的寄存器和累加寄存器解释AST抽象语法树快速翻译没有优化的字节码，编译为字节码，并转译为机械码执行，
### 优化编译器
在解释和执行的过程中会收集反馈信息，turbofan编译器根据收集的信息将那些执行了多次的代码标记为热点代码交由优化编译器turbefun为机械码，后续gnition编译器用优化的机械码代替字节码执行。这种在运行时编译代码的技术称为**JIT即时编译**。turbrfun优化编译器主要运用**内联**和**逃逸分析**优化方法。因为 V8 引擎是多线程的，TurboFan 的编译线程和生成字节码不会在同一个线程上，这样可以和 Ignition 解释器相互配合着使用，不受另一方的影响。

